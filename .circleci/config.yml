version: 2.1
jobs:
  test:
    docker:
      # specify the version you desire here
      - image: circleci/node:9

    steps:
      - checkout

      # todo: find nicer solution than constantly "cd"ing to unit_testing
      - run: cd api && npm install
      - run: cd api && npm test

      # TODO: add caching to speed things up.

  install:
    docker:
      # specify the version you desire here
      - image: circleci/node:9
    steps:
      - run: |
          curl -L https://github.com/docker/compose/releases/download/1.25.3/docker-compose-`uname -s`-`uname -m` > ~/docker-compose
          chmod +x ~/docker-compose
          sudo mv ~/docker-compose /usr/local/bin/docker-compose

  build:

    docker:
      # specify the version you desire here
      - image: circleci/node:9

    steps: 
      - run: docker-compose build


